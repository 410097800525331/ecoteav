<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>에코티브 - 브랜드굿즈제작, 티백OEM/ODM, 블렌딩티 개발, 향료 개발</title>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/package.css">
</head>

<body>
  <div id="header_wrap"></div>
  <section id="package_wrap" data-type="threeSide">
    <div class="package_inner">
      <!-- 왼쪽: 상품 이미지 -->
      <div class="product_image">
        <div class="main_img">
          <img src="/assets/img/package_three.jpg" alt="상품 이미지">
        </div>
        <ul class="thumb_list">
          <li><img src="/assets/img/package_three.jpg" alt="썸네일 1"></li>
          <li><img src="/assets/img/package_three.jpg" alt="썸네일 2"></li>
          <li><img src="/assets/img/package_three.jpg" alt="썸네일 3"></li>
        </ul>
      </div>
      <!-- 가운데: 옵션 영역 -->
      <div class="product_options">
        <h2 class="product_title">[소량제작 풀컬러] 삼방</h2>
        <div class="form_item">
          <label for="size">사이즈</label>
          <select id="size" required>
            <option value="">선택해주세요</option>
            <option>90 x 105 (티백 낱개 포장용)</option>
            <option>100 x 125 (드립백 낱개 포장용)</option>
          </select>
        </div>
        <div class="option_group">
          <label for="material">원단</label>
          <input type="text" id="material" value="PET + VMPET + LLDPE" disabled>
        </div>
        <form class="option_group">
          <fieldset class="option_group2">
            <legend>후가공</legend>
            <div class="option_inner">
              <label>지퍼</label>
              <ul class="radio_list">
                <li><label><input type="radio" name="opt1" value="77000" required> 있음</label></li>
                <li><label><input type="radio" name="opt1" value="0"> 없음</label></li>
              </ul>
              <div>0원</div>
            </div>
            <div class="option_inner">
              <label>코팅</label>
              <ul class="radio_list">
                <li><label><input type="radio" name="opt2" value="0" required> 유광</label></li>
                <li><label><input type="radio" name="opt2" value="55000"> 무광</label></li>
              </ul>
              <div>0원</div>
            </div>
            <div class="option_inner">
              <label>걸이타공</label>
              <ul class="radio_list">
                <li><label><input type="radio" name="opt3" value="0" required> 모자형</label></li>
                <li><label><input type="radio" name="opt3" value="0"> 원형</label></li>
                <li><label><input type="radio" name="opt3" value="0"> 없음</label></li>
              </ul>
              <div>0원</div>
            </div>
            <div class="option_inner">
              <label>모서리</label>
              <ul class="radio_list">
                <li><label><input type="radio" name="opt4" value="0" required> 직각</label></li>
                <li><label><input type="radio" name="opt4" value="0"> 둥근</label></li>
              </ul>
              <div>0원</div>
            </div>
            <div class="option_inner">
              <label>오픈방향</label>
              <ul class="radio_list">
                <li><label><input type="radio" name="opt9" value="0" required> 상단</label></li>
                <li><label><input type="radio" name="opt9" value="0"> 하단</label></li>
              </ul>
              <div>0원</div>
            </div>
            <div class="option_inner">
              <label>디자인 작업종류</label>
              <ul class="radio_list">
                <li><label><input type="radio" name="opt7" value="opt1T" checked> 1종</label></li>
                <li><label><input type="radio" name="opt7" value="opt2T"> 2종</label></li>
              </ul>
              <div>0원</div>
            </div>
          </fieldset>
        </form>
        <div class="option_group">
          <label for="file">디자인 파일</label>
          <input type="file" id="file" multiple accept=".ai">
        </div>
        <div class="option_group qty_group">
          <label for="qty">수량</label>
          <div class="qty_box">
            <button type="button" class="qty_btn minus">
              <i class="fa-solid fa-minus"></i>
            </button>
            <input type="number" id="qty" value="1" min="1">
            <button type="button" class="qty_btn plus">
              <i class="fa-solid fa-plus"></i>
            </button>
          </div>
          <div> = <span>4,445장</span></div>
        </div>
      </div>
      <!-- 오른쪽: 가격 및 결제 -->
      <div class="product_summary">
        <div class="summary_box">
          <p><strong>가격</strong> <span id="price">0원</span></p>
          <p><strong>추가금액</strong> <span id="add_price">0원</span></p>
          <p><strong>1장당</strong> <span id="unit_price">0원</span></p>
          <p><strong>최종결제금액</strong> <span id="total_price">0원</span></p>
        </div>
        <div class="btn_area">
          <button type="button" class="btn_ basic_btn_w">장바구니 담기</button>
          <button type="button" class="btn_ basic_btn_b">구매하기</button>
          <!-- <button type="button" class="btn_buy">견적인쇄하기</button> 추후 업데이트-->
        </div>
      </div>
    </div>
  </section>
  <div id="product_detail"></div>
  <div id="footer_wrap"></div>
  
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script>
    $(document).ready(function () {

      const BASE_PRICE = 792000;

      const sizeSelect = $('#size');
      const qtyInput = $('#qty');
      const plusBtn = $('.plus');
      const minusBtn = $('.minus');

      const priceEl = $('#price');
      const addPriceEl = $('#add_price');
      const unitPriceEl = $('#unit_price');
      const totalPriceEl = $('#total_price');

      const qtyTextEl = $('.qty_group span');

      let baseQty = 0;     // 사이즈별 기본 수량
      let multiply = 1;    // 플러스 횟수

      /* =========================
          사이즈 선택
      ========================= */

      sizeSelect.on('change', function () {

        const value = $(this).val();

        if (value && value.includes('90 x 105')) {
          baseQty = 4445;
        }
        else if (value && value.includes('100 x 125')) {
          baseQty = 4000;
        }
        else {
          baseQty = 0;
        }

        multiply = 1;
        qtyInput.val(1);

        updateAll();
      });

      /* =========================
          수량 버튼
      ========================= */

      plusBtn.on('click', function () {
        if (!baseQty) return;

        multiply++;
        qtyInput.val(multiply);
        updateAll();
      });

      minusBtn.on('click', function () {
        if (multiply > 1) {
          multiply--;
          qtyInput.val(multiply);
          updateAll();
        }
      });

      /* =========================
          옵션 변경시
      ========================= */

      $('input[type=radio]').on('change', function () {
        updateAll();
      });

      /* =========================
          전체 계산 함수
      ========================= */

      function updateAll() {

        if (!baseQty) {
          priceEl.text("0원");
          addPriceEl.text("0원");
          unitPriceEl.text("0원");
          totalPriceEl.text("0원");
          qtyTextEl.text("0장");
          return;
        }

        const totalQty = baseQty * multiply;

        /* ---- 디자인 작업종류 ---- */

        const designType = $('input[name="opt7"]:checked').val();
        let qtyText = "";

        if (designType === "opt2T") {
          const half = totalQty / 2;
          qtyText = `${totalQty.toLocaleString()}장 (상품종류별 각 ${half.toLocaleString()}장)`;
        } else {
          qtyText = `${totalQty.toLocaleString()}장`;
        }

        qtyTextEl.text(qtyText);

        /* ---- 후가공 개별 금액 표시 ---- */

        let addPrice = 0;

        $('.option_inner').each(function () {

          const checked = $(this).find('input[type=radio]:checked');
          const priceBox = $(this).find('div').last();

          if (checked.length > 0) {

            const val = checked.val();

            if (!isNaN(val)) {
              const num = Number(val);
              addPrice += num;
              priceBox.text(num.toLocaleString() + "원");
            } else {
              priceBox.text("0원");
            }

          } else {
            priceBox.text("0원");
          }

        });

        /* ---- 총 금액 계산 ---- */

        const totalPrice = BASE_PRICE + addPrice;
        const unitPrice = Math.floor(totalPrice / totalQty);

        priceEl.text(BASE_PRICE.toLocaleString() + "원");
        addPriceEl.text(addPrice.toLocaleString() + "원");
        totalPriceEl.text(totalPrice.toLocaleString() + "원");
        unitPriceEl.text(unitPrice.toLocaleString() + "원");
      }

    });
  </script>

  <script src="/js/include.js"></script>
  <script src="/js/product_detail.js"></script>
</body>

</html>